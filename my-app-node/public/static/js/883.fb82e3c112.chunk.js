"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[883],{46883:function(e,t,a){a.r(t),a.d(t,{default:function(){return i}});var l=a(84105),n={name:"ExcelFile",data(){return{name:"",tableData:[],tableHeaer:[],multipleSelection:[]}},mounted(){this.$refs.inputName.focus(),this.$axios.get("/api/company").then((e=>{this.tableData=e.data,this.tableHeaer=Object.keys(e.data[0])}))},methods:{handleSelectionChange(e){this.multipleSelection=e},handleCilckSelect(){this.createExcel(this.multipleSelection)},handleCilck(){this.createExcel(this.tableData)},createExcel(e){const t=l.P6.json_to_sheet(e),a=l.P6.book_new();l.P6.book_append_sheet(a,t,"sheet1");const n=this.name||"test";(0,l.NC)(a,`${n}.xlsx`)}}},i=(0,a(51900).Z)(n,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"btn-menu"},[t("el-input",{ref:"inputName",attrs:{placeholder:"请输入文件名(默认test)"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),e._v(" "),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleCilckSelect}},[e._v("下载选中内容")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleCilck}},[e._v("下载全部")])],1),e._v(" "),0!==e.tableData.length?t("div",{staticClass:"table"},[t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),e._l(e.tableHeaer,(function(e){return t("el-table-column",{key:e,attrs:{prop:e,label:e,align:"center"}})}))],2)],1):e._e()])}),[],!1,null,"4b8995b4",null).exports}}]);
//# sourceMappingURL=883.fb82e3c112.chunk.js.map