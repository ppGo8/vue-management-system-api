"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[947],{80947:function(e,t,a){a.r(t),a.d(t,{default:function(){return s}});var l=a(84105),r={name:"ExcelFile",data(){return{excelhtml:"",excelSrc:"",tableData:[],tableHeader:[]}},methods:{handleClick(){this.$refs["excel-upload-input"].click()},handleAddFile(e){const t=e.target.files[0];if(t){if(this.$refs["excel-upload-input"].value=null,t.size>=1048576)return this.$message.warning("请勿上传大于1M的文件!");this.upload(t)}},handleDragover(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},handleDrop(e){e.stopPropagation(),e.preventDefault();const t=e.dataTransfer.files;if(1!==t.length)return this.$message.warning("仅支持上传一个文件!");const a=t[0];if(!this.isExcel(a))return this.$message.error("仅支持excel类型文件");this.upload(a),e.stopPropagation(),e.preventDefault()},upload(e){e&&e.arrayBuffer().then((e=>{const t=(0,l.ij)(e).Sheets.Sheet1,a=l.P6.sheet_to_json(t);this.tableData=a,this.tableHeader=Object.keys(a[0])}))},isExcel(e){return/\.(xlsx|xls|csv)$/.test(e.name)}}},s=(0,a(51900).Z)(r,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"file"},[t("input",{ref:"excel-upload-input",staticClass:"excel-upload-input",attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.handleAddFile}}),e._v(" "),t("div",{staticClass:"drop",on:{drop:e.handleDrop,dragover:e.handleDragover,dragenter:e.handleDragover,dragleave:e.handleDragover}},[e._v("\n      将文件拖到此处 或\n      "),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleClick}},[e._v("点击上传")])],1)]),e._v(" "),t("div",{ref:"table",staticClass:"table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},e._l(e.tableHeader,(function(e){return t("el-table-column",{key:e,attrs:{prop:e,label:e}})})),1)],1)])}),[],!1,null,"5d41b7d3",null).exports}}]);
//# sourceMappingURL=947.579efaf53d.chunk.js.map