{"version":3,"file":"static/js/883.fb82e3c112.chunk.js","mappings":"mJAAA,I,WCA6L,EC0C7L,CACAA,KAAA,YACAC,IAAAA,GACA,OACAD,KAAA,GACAE,UAAA,GACAC,WAAA,GAEAC,kBAAA,GAEA,EACAC,OAAAA,GAEA,KAAAC,MAAAC,UAAAC,QAEA,KAAAC,OAAAC,IAAA,gBAAAC,MAAAC,IACA,KAAAV,UAAAU,EAAAX,KACA,KAAAE,WAAAU,OAAAC,KAAAF,EAAAX,KAAA,MAEA,EACAc,QAAA,CACAC,qBAAAA,CAAAC,GAGA,KAAAb,kBAAAa,CACA,EAEAC,iBAAAA,GACA,KAAAC,YAAA,KAAAf,kBACA,EAEAgB,WAAAA,GACA,KAAAD,YAAA,KAAAjB,UACA,EAEAiB,WAAAA,CAAAlB,GACA,MAAAoB,EAAAC,EAAAA,GAAAA,cAAArB,GACAsB,EAAAD,EAAAA,GAAAA,WACAA,EAAAA,GAAAA,kBAAAC,EAAAF,EAAA,UAEA,MAAAG,EAAA,KAAAxB,MAAA,QACAyB,EAAAA,EAAAA,IAAAF,EAAA,GAAAC,SAGA,ICnEA,GAXgB,E,SAAA,GACd,GHTW,WAAkB,IAAIE,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,WAAW,CAACG,IAAI,YAAYC,MAAM,CAAC,YAAc,kBAAkBC,MAAM,CAACC,MAAOR,EAAI1B,KAAMmC,SAAS,SAAUC,GAAMV,EAAI1B,KAAKoC,CAAG,EAAEC,WAAW,UAAUX,EAAIY,GAAG,KAAKV,EAAG,YAAY,CAACI,MAAM,CAAC,KAAO,UAAU,KAAO,QAAQO,GAAG,CAAC,MAAQb,EAAIR,oBAAoB,CAACQ,EAAIY,GAAG,YAAYV,EAAG,YAAY,CAACI,MAAM,CAAC,KAAO,UAAU,KAAO,QAAQO,GAAG,CAAC,MAAQb,EAAIN,cAAc,CAACM,EAAIY,GAAG,WAAW,GAAGZ,EAAIY,GAAG,KAA+B,IAAzBZ,EAAIxB,UAAUsC,OAAcZ,EAAG,MAAM,CAACE,YAAY,SAAS,CAACF,EAAG,WAAW,CAACG,IAAI,gBAAgBU,YAAY,CAAC,MAAQ,QAAQT,MAAM,CAAC,KAAON,EAAIxB,UAAU,iBAAiB,OAAO,wBAAwB,IAAIqC,GAAG,CAAC,mBAAmBb,EAAIV,wBAAwB,CAACY,EAAG,kBAAkB,CAACI,MAAM,CAAC,KAAO,YAAY,MAAQ,KAAK,MAAQ,YAAYN,EAAIY,GAAG,KAAKZ,EAAIgB,GAAIhB,EAAIvB,YAAY,SAASwC,GAAM,OAAOf,EAAG,kBAAkB,CAACgB,IAAID,EAAKX,MAAM,CAAC,KAAOW,EAAK,MAAQA,EAAK,MAAQ,WAAW,KAAI,IAAI,GAAGjB,EAAImB,MACz+B,GACsB,IGUpB,EACA,KACA,WACA,MAI8B,O","sources":["webpack://my-app/./src/views/ExcelExport.vue","webpack://my-app/./src/views/ExcelExport.vue?fb8e","webpack://my-app/src/views/ExcelExport.vue","webpack://my-app/./src/views/ExcelExport.vue?290b"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',{staticClass:\"btn-menu\"},[_c('el-input',{ref:\"inputName\",attrs:{\"placeholder\":\"请输入文件名(默认test)\"},model:{value:(_vm.name),callback:function ($$v) {_vm.name=$$v},expression:\"name\"}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":_vm.handleCilckSelect}},[_vm._v(\"下载选中内容\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":_vm.handleCilck}},[_vm._v(\"下载全部\")])],1),_vm._v(\" \"),(_vm.tableData.length !== 0)?_c('div',{staticClass:\"table\"},[_c('el-table',{ref:\"multipleTable\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.tableData,\"tooltip-effect\":\"dark\",\"highlight-current-row\":\"\"},on:{\"selection-change\":_vm.handleSelectionChange}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"55\",\"align\":\"center\"}}),_vm._v(\" \"),_vm._l((_vm.tableHeaer),function(item){return _c('el-table-column',{key:item,attrs:{\"prop\":item,\"label\":item,\"align\":\"center\"}})})],2)],1):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-7!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ExcelExport.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-7!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ExcelExport.vue?vue&type=script&lang=js&\"","<template>\r\n  <div>\r\n    <!-- 区域1：按钮 -->\r\n    <div class=\"btn-menu\">\r\n      <el-input\r\n        v-model=\"name\"\r\n        ref=\"inputName\"\r\n        placeholder=\"请输入文件名(默认test)\"\r\n      ></el-input>\r\n      <el-button type=\"primary\" size=\"mini\" @click=\"handleCilckSelect\"\r\n        >下载选中内容</el-button\r\n      ><el-button type=\"primary\" size=\"mini\" @click=\"handleCilck\"\r\n        >下载全部</el-button\r\n      >\r\n    </div>\r\n    <!-- 区域2:表格区域 -->\r\n    <div class=\"table\" v-if=\"tableData.length !== 0\">\r\n      <el-table\r\n        ref=\"multipleTable\"\r\n        :data=\"tableData\"\r\n        tooltip-effect=\"dark\"\r\n        style=\"width: 100%\"\r\n        highlight-current-row\r\n        @selection-change=\"handleSelectionChange\"\r\n      >\r\n        <el-table-column type=\"selection\" width=\"55\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column\r\n          v-for=\"item in tableHeaer\"\r\n          :key=\"item\"\r\n          :prop=\"item\"\r\n          :label=\"item\"\r\n          align=\"center\"\r\n        >\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { read, utils, writeFile } from \"xlsx\";\r\nexport default {\r\n  name: \"ExcelFile\",\r\n  data() {\r\n    return {\r\n      name: \"\",\r\n      tableData: [],\r\n      tableHeaer: [],\r\n      // 存储用户选中的数据\r\n      multipleSelection: [],\r\n    };\r\n  },\r\n  mounted() {\r\n    // 表单自动获得焦点\r\n    this.$refs.inputName.focus();\r\n    // 获取数据\r\n    this.$axios.get(\"/api/company\").then((res) => {\r\n      this.tableData = res.data;\r\n      this.tableHeaer = Object.keys(res.data[0]);\r\n    });\r\n  },\r\n  methods: {\r\n    handleSelectionChange(val) {\r\n      // element-ui的selection-change事件:选中的内容发生变化\r\n      // 每次都会返回最新的已选中数据\r\n      this.multipleSelection = val;\r\n    },\r\n    // 下载选中内容\r\n    handleCilckSelect() {\r\n      this.createExcel(this.multipleSelection);\r\n    },\r\n    // 下载全部内容\r\n    handleCilck() {\r\n      this.createExcel(this.tableData);\r\n    },\r\n    // 导出内容为excel\r\n    createExcel(data) {\r\n      const ws = utils.json_to_sheet(data);\r\n      const wb = utils.book_new(); // 创建新的工作簿\r\n      utils.book_append_sheet(wb, ws, \"sheet1\");\r\n      // 浏览器以下载的方式输出wb\r\n      const filename = this.name || \"test\";\r\n      writeFile(wb, `${filename}.xlsx`);\r\n      // 转换table dom为excel\r\n      // 略\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.btn-menu {\r\n  display: flex;\r\n  margin: 10px;\r\n  .el-input {\r\n    width: 300px;\r\n    margin-right: 5px;\r\n  }\r\n}\r\n</style>","import { render, staticRenderFns } from \"./ExcelExport.vue?vue&type=template&id=4b8995b4&scoped=true&\"\nimport script from \"./ExcelExport.vue?vue&type=script&lang=js&\"\nexport * from \"./ExcelExport.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ExcelExport.vue?vue&type=style&index=0&id=4b8995b4&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4b8995b4\",\n  null\n  \n)\n\nexport default component.exports"],"names":["name","data","tableData","tableHeaer","multipleSelection","mounted","$refs","inputName","focus","$axios","get","then","res","Object","keys","methods","handleSelectionChange","val","handleCilckSelect","createExcel","handleCilck","ws","utils","wb","filename","writeFile","_vm","this","_c","_self","staticClass","ref","attrs","model","value","callback","$$v","expression","_v","on","length","staticStyle","_l","item","key","_e"],"sourceRoot":""}