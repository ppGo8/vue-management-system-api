(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[730],{87237:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return o}});var i=a(80129),n=a.n(i),s={name:"Dialog",props:{dialog:Object,formData:Object},data(){return{format_type_list:["提现","提现手续费","充值","优惠券","充值礼券","转账"],from_rules:{description:[{required:!0,message:"收支描述不能为空！",trigger:"blur"}],income:[{required:!0,message:"收入不能为空！",trigger:"blur"},{type:"number",message:"必须为数字值",trigger:"blur"}],expenditure:[{required:!0,message:"支出不能为空！",trigger:"blur"},{type:"number",message:"必须为数字值",trigger:"blur"}],account:[{required:!0,message:"账户不能为空！",trigger:"blur"},{type:"number",message:"必须为数字值",trigger:"blur"}]}}},methods:{onSubmit(t){this.$refs[t].validate((t=>{t&&("add"===this.dialog.option?this.$axios.post("/api/funds",n().stringify(this.formData)).then((t=>{console.log(t),this.$message.success("数据添加成功")})).catch((t=>{console.log(t)})):this.$axios.put(`/api/funds/${this.formData.id}`,n().stringify(this.formData)).then((t=>{console.log(t),this.$message.success("数据编辑成功")})).catch((t=>{console.log(t)})),this.dialog.show=!1,this.$emit("update"))}))}}},l=a(51900),r={name:"fundList",components:{Dialog:(0,l.Z)(s,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"dialog"},[e("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,"close-on-click-modal":!0,"close-on-press-escape":!1,"modal-append-to-body":!1},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[e("div",{staticClass:"form"},[e("el-form",{ref:"form",staticStyle:{margin:"10px",width:"auto"},attrs:{rules:t.from_rules,model:t.formData,"label-width":"120px"}},[e("el-form-item",{attrs:{label:"收支类型:"}},[e("el-select",{attrs:{placeholder:"收支类型"},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},t._l(t.format_type_list,(function(t,a){return e("el-option",{key:a,attrs:{label:t,value:t}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{prop:"description",label:"收支描述:"}},[e("el-input",{attrs:{type:"description"},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1),t._v(" "),e("el-form-item",{attrs:{prop:"income",label:"收入:"}},[e("el-input",{attrs:{type:"income"},model:{value:t.formData.income,callback:function(e){t.$set(t.formData,"income",t._n(e))},expression:"formData.income"}})],1),t._v(" "),e("el-form-item",{attrs:{prop:"expenditure",label:"支出:"}},[e("el-input",{attrs:{type:"expenditure"},model:{value:t.formData.expenditure,callback:function(e){t.$set(t.formData,"expenditure",t._n(e))},expression:"formData.expenditure"}})],1),t._v(" "),e("el-form-item",{attrs:{prop:"account",label:"账户现金:"}},[e("el-input",{attrs:{type:"account"},model:{value:t.formData.account,callback:function(e){t.$set(t.formData,"account",t._n(e))},expression:"formData.account"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"备注:"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.formData.remark,callback:function(e){t.$set(t.formData,"remark",e)},expression:"formData.remark"}})],1),t._v(" "),e("el-form-item",{staticClass:"text_right"},[e("el-button",{on:{click:function(e){t.dialog.show=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("form")}}},[t._v("提交")])],1)],1)],1)])],1)}),[],!1,null,null,null).exports},computed:{user(){return this.$store.getters["m_admin/user"]}},data(){return{search_data:{startTime:"",endTime:""},formData:{type:"",description:"",income:"",expenditure:"",account:"",remark:"",id:""},tableData:[],allTableData:[],filterTableData:[],dialog:{show:!1,title:"",option:"edit"},paginations:{page_index:1,total:0,page_size:5,page_sizes:[5,10,15,20],layout:"total, sizes, prev, pager, next, jumper"}}},created(){this.getProfile()},methods:{getProfile(){this.$axios.get("/api/funds").then((t=>{this.allTableData=t.data,this.filterTableData=t.data,this.setPaginations()})).catch((t=>{console.log(t)}))},handleSearch(){if(!this.search_data.startTime||!this.search_data.endTime)return this.$message.warning("请选择时间区间"),void this.getProfile();const t=this.search_data.startTime.getTime(),e=this.search_data.endTime.getTime();this.allTableData=this.filterTableData.filter((a=>{let i=new Date(a.date).getTime();return i>=t&&i<=e})),this.setPaginations()},onAddMoney(){this.dialog={show:!0,title:"添加资金信息",option:"add"},this.formData={type:"",description:"",income:"",expenditure:"",account:"",remark:"",id:""}},handleEdit(t,e){this.dialog={show:!0,title:"修改资金信息",option:"edit"},this.formData={type:e.type,description:e.description,income:e.income,expenditure:e.expenditure,account:e.account,remark:e.remark,id:e.id}},handleDelete(t,e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.delete(`/api/funds/${e.id}`).then((t=>{this.$message.success("删除成功"),this.getProfile()})).catch((t=>{console.log(t)}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},setPaginations(){this.paginations.total=this.allTableData.length,this.paginations.page_index=1,this.paginations.page_size=5,this.tableData=this.allTableData.filter(((t,e)=>e<this.paginations.page_size))},handleSizeChange(t){this.paginations.page_index=1,this.paginations.page_size=t,this.tableData=this.allTableData.filter(((t,e)=>e<this.paginations.page_size))},handleCurrentChange(t){const e=this.paginations.page_size*(t-1),a=this.paginations.page_size*t;this.tableData=this.allTableData.filter(((t,i)=>i<a&&i>=e))}}},o=(0,l.Z)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"fillcontain"},[e("div",{staticClass:"btn"},[e("el-form",{ref:"search_data",attrs:{inline:!0,model:t.search_data}},[e("el-form-item",{attrs:{label:"按照时间筛选:"}},[e("el-date-picker",{attrs:{type:"date",placeholder:"选择开始时间"},model:{value:t.search_data.startTime,callback:function(e){t.$set(t.search_data,"startTime",e)},expression:"search_data.startTime"}}),t._v("\n        --\n        "),e("el-date-picker",{attrs:{type:"date",placeholder:"选择结束时间"},model:{value:t.search_data.endTime,callback:function(e){t.$set(t.search_data,"endTime",e)},expression:"search_data.endTime"}})],1),t._v(" "),e("el-form-item",[e("el-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.handleSearch()}}},[t._v("筛选")])],1),t._v(" "),e("el-form-item",{staticClass:"btnAdd"},[e("el-button",{attrs:{type:"primary",icon:"view"},on:{click:t.onAddMoney}},[t._v("添加")])],1)],1)],1),t._v(" "),e("div",{staticClass:"table-container"},[t.tableData.length>0?e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),t._v(" "),e("el-table-column",{attrs:{prop:"date",label:"创建时间",align:"center",width:"150",sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-icon",{attrs:{name:"time"}}),t._v(" "),e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(a.row.date.substring(0,10)))])]}}],null,!1,2510732311)}),t._v(" "),e("el-table-column",{attrs:{prop:"type",label:"收支类型",align:"center",width:"150"}}),t._v(" "),e("el-table-column",{attrs:{prop:"description",label:"收支描述",align:"center",width:"150"}}),t._v(" "),e("el-table-column",{attrs:{prop:"income",label:"收入",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticStyle:{color:"#00d053"}},[t._v("+ "+t._s(a.row.income))])]}}],null,!1,2743434154)}),t._v(" "),e("el-table-column",{attrs:{prop:"expenditure",label:"支出",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticStyle:{color:"#f56767"}},[t._v("- "+t._s(a.row.expenditure))])]}}],null,!1,2125046451)}),t._v(" "),e("el-table-column",{attrs:{prop:"account",label:"账户现金",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticStyle:{color:"#4db3ff"}},[t._v(t._s(a.row.account))])]}}],null,!1,503425595)}),t._v(" "),e("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center",width:"200"}}),t._v(" "),e("el-table-column",{attrs:{prop:"operation",align:"center",label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"warning",icon:"deit",size:"mini",disabled:"admin"!==t.user.identity},on:{click:function(e){return t.handleEdit(a.$index,a.row)}}},[t._v("编辑")]),t._v(" "),e("el-button",{attrs:{size:"mini",icon:"delete",type:"danger",disabled:"admin"!==t.user.identity},on:{click:function(e){return t.handleDelete(a.$index,a.row)}}},[t._v("删除")])]}}],null,!1,3631556994)})],1):t._e(),t._v(" "),e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"pagination"},[e("el-pagination",{attrs:{"current-page":t.paginations.page_index,"page-sizes":t.paginations.page_sizes,"page-size":t.paginations.page_size,layout:t.paginations.layout,total:t.paginations.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.paginations,"page_index",e)},"update:current-page":function(e){return t.$set(t.paginations,"page_index",e)}}})],1)])],1)],1),t._v(" "),e("Dialog",{attrs:{dialog:t.dialog,formData:t.formData},on:{update:t.getProfile}})],1)}),[],!1,null,"0c6e1082",null).exports},24654:function(){}}]);
//# sourceMappingURL=730.d9b30f7159.chunk.js.map